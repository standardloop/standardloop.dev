{"config":{"separator":"[\\s\\-_,:!=\\[\\]()\\\\\"`/]+|\\.(?!\\d)"},"items":[{"location":"","level":1,"title":"Intro","text":"<p>Hello!</p>","path":["Intro"],"tags":[]},{"location":"links/","level":1,"title":"Links","text":"<ul> <li>Medium: @standardloop</li> <li>GitHub: /standardloop</li> <li>YouTube /StandardLoop</li> </ul>","path":["Links"],"tags":[]},{"location":"tech-articles/intro-to-kind/","level":1,"title":"Introduction to Local Kubernetes Using Kind","text":"","path":["Tech Articles","Introduction to Local Kubernetes Using Kind"],"tags":[]},{"location":"tech-articles/intro-to-kind/#background","level":2,"title":"Background","text":"<p>kind is a tool for running local Kubernetes clusters using Docker container “nodes”. kind was primarily designed for testing Kubernetes itself, but may be used for local development or CI.</p> <p>Kind is part of the Kubernetes Special Interest Groups (SIGS)</p> <p>Special Interest Groups in Kubernetes provide places for the community to focus development and discussion on a particular part of the project.</p> <p>You can find the Kind source code here: - https://github.com/kubernetes-sigs/kind</p> <p>and the documentation here: - https://kind.sigs.k8s.io/</p>","path":["Tech Articles","Introduction to Local Kubernetes Using Kind"],"tags":[]},{"location":"tech-articles/intro-to-kind/#prerequisites","level":2,"title":"Prerequisites","text":"","path":["Tech Articles","Introduction to Local Kubernetes Using Kind"],"tags":[]},{"location":"tech-articles/intro-to-kind/#general-knowledge","level":3,"title":"General Knowledge","text":"<ul> <li><code>docker</code></li> <li><code>brew</code> (or your preferred package manager)</li> <li>YAML</li> <li><code>helm</code></li> <li><code>kubectl</code></li> </ul>","path":["Tech Articles","Introduction to Local Kubernetes Using Kind"],"tags":[]},{"location":"tech-articles/intro-to-kind/#install-and-setup","level":3,"title":"Install and Setup","text":"","path":["Tech Articles","Introduction to Local Kubernetes Using Kind"],"tags":[]},{"location":"tech-articles/intro-to-kind/#docker","level":4,"title":"Docker","text":"<p>Have <code>docker</code> installed and have a docker engine running.</p> <p>For this article, I will be using Rancher Desktop.</p> <p>You can install Rancher Desktop with <code>brew</code> like this:</p> <pre><code>$ brew install --cask rancher\n</code></pre> <p>You can check your <code>docker</code> version with the following command: <pre><code>$ docker --version\nDocker version 28.1.1-rd, build 4d7f01e\n</code></pre></p> <p>Make sure your <code>docker</code> engine is running. You can check if it is with the following command: <pre><code>$ docker info &gt; /dev/null 2&gt;&amp;1\n$ echo $?\n0  # if it isn't running you should see a 1\n</code></pre></p>","path":["Tech Articles","Introduction to Local Kubernetes Using Kind"],"tags":[]},{"location":"tech-articles/intro-to-kind/#kind","level":4,"title":"<code>kind</code>","text":"<p>I recommend installing using a package manager such as <code>brew</code> for macOS:</p> <pre><code>$ brew install kind\n$ which kind\n/opt/homebrew/bin/kind\n$ kind --version\nkind version 0.30.0\n</code></pre>","path":["Tech Articles","Introduction to Local Kubernetes Using Kind"],"tags":[]},{"location":"tech-articles/intro-to-kind/#creating-a-cluster-with-a-yaml-config-file","level":2,"title":"Creating a cluster with a yaml config file","text":"<ul> <li>https://kind.sigs.k8s.io/docs/user/configuration/</li> </ul>","path":["Tech Articles","Introduction to Local Kubernetes Using Kind"],"tags":[]},{"location":"tech-articles/intro-to-kind/#background_1","level":3,"title":"Background","text":"<p>I will naming my cluster <code>slke-1</code> (standardloop kubernetes engine 1).</p> <p>You can create clusters without config files, but I always recommend getting in the habit of using them for repeatable behavior.</p> <p>There are two kinds of node types, <code>control-plane</code> and <code>worker</code>.</p> <p>A single <code>control-plane</code> node is always required.</p> <p>If you try to make one without, you will see an error message such as this.</p> <pre><code>ERROR: failed to create cluster: must have at least one control-plane node\n</code></pre>","path":["Tech Articles","Introduction to Local Kubernetes Using Kind"],"tags":[]},{"location":"tech-articles/intro-to-kind/#config","level":3,"title":"Config","text":"<p>Make sure to check the newest version, you can find the images here: - https://hub.docker.com/r/kindest/node/</p> <p>I will create a file named <code>kind-config.yaml</code> and place the following contents in it:</p> <p><pre><code>---\nkind: Cluster\napiVersion: kind.x-k8s.io/v1alpha4\nname: slke-1\nnodes:\n  - role: control-plane\n    image: kindest/node:v1.34.0\n  - role: worker\n    image: kindest/node:v1.34.0\n</code></pre> Here we are creating two nodes, one for the control-plane and one worker.</p> <pre><code>$ kind create cluster --config=./kind-config.yaml\n...\n</code></pre> <p>You can use a tool such as kubectx to ensure your context is set. <pre><code>$ kubectx\nkind-slke-1\n</code></pre> Notice how the name is prefixed with <code>kind-</code></p>","path":["Tech Articles","Introduction to Local Kubernetes Using Kind"],"tags":[]},{"location":"tech-articles/intro-to-kind/#see-the-nodes-running","level":3,"title":"See the nodes running","text":"","path":["Tech Articles","Introduction to Local Kubernetes Using Kind"],"tags":[]},{"location":"tech-articles/intro-to-kind/#use-docker-ps-to-see-the-nodes-running","level":4,"title":"Use <code>docker ps</code> to see the nodes running","text":"<pre><code>$ docker ps\nCONTAINER ID   IMAGE                  COMMAND                  CREATED         STATUS         PORTS                       NAMES\n4b59fab194e5   kindest/node:v1.34.0   \"/usr/local/bin/entr…\"   2 minutes ago   Up 2 minutes   127.0.0.1:57499-&gt;6443/tcp   slke-1-control-plane\nbdf56ba1fc15   kindest/node:v1.34.0   \"/usr/local/bin/entr…\"   2 minutes ago   Up 2 minutes                               slke-1-worker\n</code></pre>","path":["Tech Articles","Introduction to Local Kubernetes Using Kind"],"tags":[]},{"location":"tech-articles/intro-to-kind/#kubectl-get-nodes","level":4,"title":"<code>kubectl get nodes</code>","text":"<pre><code>$ kubectl get nodes\nNAME                   STATUS   ROLES           AGE   VERSION\nslke-1-control-plane   Ready    control-plane   15m   v1.34.0\nslke-1-worker          Ready    &lt;none&gt;          15m   v1.34.0\n</code></pre> <p>If it is bothering you that <code>ROLES</code> is empty for the <code>worker</code> node, you can run: <pre><code>$ kubectl label nodes slke-1-worker node-role.kubernetes.io/worker=\"\"\nnode/slke-1-worker labeled\n$ kubectl get nodes\nNAME                   STATUS   ROLES           AGE   VERSION\nslke-1-control-plane   Ready    control-plane   16m   v1.34.0\nslke-1-worker          Ready    worker          16m   v1.34.0\n</code></pre></p>","path":["Tech Articles","Introduction to Local Kubernetes Using Kind"],"tags":[]},{"location":"tech-articles/intro-to-kind/#updating-the-cluster","level":3,"title":"Updating the Cluster","text":"<p>You cannot update a cluster after creation, so you will need to delete it and then recreate it if you are changing any config.</p>","path":["Tech Articles","Introduction to Local Kubernetes Using Kind"],"tags":[]},{"location":"tech-articles/intro-to-kind/#setting-up-cloud-provider-kind","level":3,"title":"Setting up <code>cloud-provider-kind</code>","text":"<p><code>cloud-provider-kind</code> allows you to use a Kubernetes <code>Service</code> type LoadBalancer.</p> <p>The reason it is called <code>cloud-provider-kind</code> is because when you use a Kubernetes <code>Service</code> type <code>LoadBalancer</code> in a cloud environment, such as Google Kubernetes Engine, the Cloud Provider will setup some infrastructure behind the scenes to allow routing.</p> <p>Previously, you had to configure MetalLB (which was a more involved setup and had issues on macOS), or use Extra Port Mappings (which was a simple solution, but it felt more hacky and different from what would be used in a production environment).</p>","path":["Tech Articles","Introduction to Local Kubernetes Using Kind"],"tags":[]},{"location":"tech-articles/intro-to-kind/#install","level":4,"title":"Install","text":"<pre><code>$ brew install cloud-provider-kind\n$ which cloud-provider-kind\n/opt/homebrew/bin/cloud-provider-kind\n</code></pre>","path":["Tech Articles","Introduction to Local Kubernetes Using Kind"],"tags":[]},{"location":"tech-articles/intro-to-kind/#run","level":4,"title":"Run","text":"<p>I recommend opening a separate terminal session for running this command to easily view the logs.</p> <p>According to the README of the repository, you will need to run with <code>sudo</code> <pre><code>$ sudo cloud-provider-kind\n</code></pre></p> <p>You can watch the log information when a Kubernetes <code>Service</code> type <code>LoadBalancer</code> is created or deleted.</p> <p>You can also view the docker container running:</p> <pre><code>$ docker ps\nCONTAINER ID   IMAGE                      COMMAND                  CREATED          STATUS          PORTS                                                                                                                                     NAMES\na411bd911a94   envoyproxy/envoy:v1.33.2   \"/docker-entrypoint.…\"   4 seconds ago    Up 3 seconds    0.0.0.0:32774-&gt;80/tcp, [::]:32774-&gt;80/tcp, 0.0.0.0:32775-&gt;443/tcp, [::]:32775-&gt;443/tcp, 0.0.0.0:32776-&gt;10000/tcp, [::]:32776-&gt;10000/tcp   kindccm-f53170ec34f3\n...\n</code></pre>","path":["Tech Articles","Introduction to Local Kubernetes Using Kind"],"tags":[]},{"location":"tech-articles/intro-to-kind/#deploying-ingress-nginx-as-our-loadbalancer","level":3,"title":"Deploying <code>ingress-nginx</code> as our <code>LoadBalancer</code>","text":"","path":["Tech Articles","Introduction to Local Kubernetes Using Kind"],"tags":[]},{"location":"tech-articles/intro-to-kind/#creating-a-values-file","level":4,"title":"Creating a values file","text":"<p>I will create a file called <code>ingress-nginx.values.yaml</code> with the following contents:</p> <pre><code>controller:\n  service:\n    type: \"LoadBalancer\"\n</code></pre> <p>You can pass values as command line arguments, but I prefer values files as it helps with upgrading the release if needed.</p>","path":["Tech Articles","Introduction to Local Kubernetes Using Kind"],"tags":[]},{"location":"tech-articles/intro-to-kind/#deploy-the-helm-chart","level":3,"title":"Deploy the helm chart","text":"<p>Make sure to use the latest chart version, for me it was <code>4.13.3</code>.</p> <pre><code>$ helm repo add ingress-nginx https://kubernetes.github.io/ingress-nginx\n$ helm repo update\n$ helm upgrade --install ingress-nginx ingress-nginx/ingress-nginx \\\n    --create-namespace \\\n    -n ingress-nginx \\\n    --values ingress-nginx.values.yaml \\\n    --version 4.13.3 \\\n    --wait\n</code></pre>","path":["Tech Articles","Introduction to Local Kubernetes Using Kind"],"tags":[]},{"location":"tech-articles/intro-to-kind/#confirm-installation","level":4,"title":"Confirm installation","text":"","path":["Tech Articles","Introduction to Local Kubernetes Using Kind"],"tags":[]},{"location":"tech-articles/intro-to-kind/#check-namespace-pod-and-service","level":5,"title":"Check namespace, pod, and service","text":"<pre><code>$ kubectl get ns\nNAME                 STATUS   AGE\ndefault              Active   21m\ningress-nginx        Active   2m12s\nkube-node-lease      Active   21m\nkube-public          Active   21m\nkube-system          Active   21m\nlocal-path-storage   Active   21m\n$ kubectl get pods -n ingress-nginx\nNAME                                        READY   STATUS    RESTARTS   AGE\ningress-nginx-controller-6f6c964579-csllp   1/1     Running   0          2m27s\n$ kubectl get svc -n ingress-nginx\nkubectl get svc -n ingress-nginx\nNAME                                 TYPE           CLUSTER-IP     EXTERNAL-IP   PORT(S)                      AGE\ningress-nginx-controller             LoadBalancer   10.96.241.10   172.18.0.4    80:32725/TCP,443:30829/TCP   2m51s\ningress-nginx-controller-admission   ClusterIP      10.96.249.13   &lt;none&gt;        443/TCP                      2m51s\n</code></pre> <p>If your <code>EXTERNAL-IP</code> for the <code>ingress-nginx-controller</code> svc is showing <code>&lt;pending&gt;</code> make sure <code>cloud-provider-kind</code> is running and inspect the logs.</p> <p>Easy way to print out your IP address: <pre><code>$ kubectl get svc/ingress-nginx-controller -n ingress-nginx -o=jsonpath='{.status.loadBalancer.ingress[0].ip}'\n172.18.0.4\n</code></pre></p>","path":["Tech Articles","Introduction to Local Kubernetes Using Kind"],"tags":[]},{"location":"tech-articles/intro-to-kind/#use-curl-to-hit-the-loadbalancer","level":5,"title":"Use <code>curl</code> to hit the <code>LoadBalancer</code>","text":"<pre><code>$ curl http://172.18.0.4\n&lt;html&gt;\n&lt;head&gt;&lt;title&gt;404 Not Found&lt;/title&gt;&lt;/head&gt;\n&lt;body&gt;\n&lt;center&gt;&lt;h1&gt;404 Not Found&lt;/h1&gt;&lt;/center&gt;\n&lt;hr&gt;&lt;center&gt;nginx&lt;/center&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>Awesome!</p>","path":["Tech Articles","Introduction to Local Kubernetes Using Kind"],"tags":[]},{"location":"tech-articles/intro-to-kind/#configure-etchosts","level":3,"title":"Configure <code>/etc/hosts</code>","text":"<p>Using the IP address we got from: <pre><code>$ kubectl get svc/ingress-nginx-controller -n ingress-nginx -o=jsonpath='{.status.loadBalancer.ingress[0].ip}'\n</code></pre></p> <p>We can update <code>/etc/hosts</code> to have a nice looking URL.</p> <pre><code>$ sudo vim /etc/hosts\n...\n172.18.0.4      kind.local\n</code></pre> <p>Now you can go to http://kind.local</p>","path":["Tech Articles","Introduction to Local Kubernetes Using Kind"],"tags":[]},{"location":"tech-articles/intro-to-kind/#deploy-a-sample-app-and-use-the-ingress-controller","level":3,"title":"Deploy a Sample App and use the Ingress Controller","text":"<p>I will be using the hashicorp http-echo server has my example app.</p> <p>Make sure to use the most up to date image, you can view the images here.</p> <p>I will create a file called <code>app.yaml</code> and add the following manifests in it:</p> <pre><code>---\napiVersion: v1\nkind: Namespace\nmetadata:\n  name: app\n---\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: http-echo-deployment\n  namespace: app\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: http-echo\n  template:\n    metadata:\n      labels:\n        app: http-echo\n    spec:\n      containers:\n        - name: http-echo\n          image: hashicorp/http-echo:1.0.0\n          args: [\"-text\", \"Hello from Kubernetes!\", \"-listen\", \":8080\"]\n          ports:\n            - containerPort: 8080\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: http-echo-service\n  namespace: app\nspec:\n  selector:\n    app: http-echo\n  ports:\n    - protocol: TCP\n      port: 80\n      targetPort: 8080\n  type: ClusterIP\n---\napiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: http-echo-service-ingress\n  namespace: app\nspec:\n  ingressClassName: nginx\n  rules:\n    - host: kind.local\n      http:\n        paths:\n          - path: /\n            pathType: ImplementationSpecific\n            backend:\n              service:\n                name: http-echo-service\n                port:\n                  number: 80\n</code></pre> <pre><code>$ kubectl apply -f app.yaml\nnamespace/app created\ndeployment.apps/http-echo-deployment created\nservice/http-echo-service created\ningress.networking.k8s.io/http-echo-service-ingress created\n</code></pre> <p>Go to http://kind.local and see the message!</p>","path":["Tech Articles","Introduction to Local Kubernetes Using Kind"],"tags":[]},{"location":"tech-articles/intro-to-kind/#cleaning-up","level":3,"title":"Cleaning up","text":"<p>stop your <code>cloud-provider-kind</code> by Ctrl+C'ing the terminal or by looking the processes and stopping it.</p> <p>And then delete your cluster: <pre><code>$ kind delete cluster --name slke-1\n</code></pre></p>","path":["Tech Articles","Introduction to Local Kubernetes Using Kind"],"tags":[]},{"location":"tech-articles/intro-to-kind/#tldr","level":2,"title":"TLDR","text":"<p>Use my provided <code>Taskfile.yml</code> and run it all yourself easily!</p> <ul> <li>https://github.com/standardloop/knowledge-transfer/blob/main/01-kind/Taskfile.yml</li> </ul> <pre><code>$ task\n</code></pre>","path":["Tech Articles","Introduction to Local Kubernetes Using Kind"],"tags":[]}]}